{"version":3,"file":"static/webpack/static/development/pages/result.js.40e1d22ec8441f4fa734.hot-update.js","sources":["webpack:///./pages/result.js"],"sourcesContent":["import { format, addDays } from \"date-fns\"\nimport styled from \"styled-components\"\nimport Button from \"@kiwicom/orbit-components/lib/Button\"\nimport Stack from \"@kiwicom/orbit-components/lib/Stack\"\nimport Heading from \"@kiwicom/orbit-components/lib/Heading\"\nimport ChevronLeft from \"@kiwicom/orbit-components/lib/icons/ChevronLeft\"\nimport Router from \"next/router\"\n\nimport Query from \"../components/query\"\nimport search from \"../queries/search.gql\"\nimport Debug from \"../components/debug\"\nimport ContentContainer from \"../components/ContentContainer\"\nimport Footer from \"../components/Footer\"\nimport Itinerary from \"../components/Itinerary\"\n\nconst ResultsContainer = styled.div`\n  max-width: 1024px;\n  padding-bottom: 90px;\n`\n\n/*\nFor usage online\n{\n  \"params\": {\n    \"adults\": 1,\n    \"dateFrom\": \"29/01/2019\",\n    \"dateTo\": \"29/03/2019\",\n    \"flyFrom\": \"vienna_at\",\n    \"flyTo\": \"vienna_at\",\n    \"stopovers\": [\n      {\"locations\": [\"LON\"], \"nightsFrom\": 1, \"nightsTo\": 7},\n       {\"locations\": [\"PAR\"], \"nightsFrom\": 1, \"nightsTo\": 7}\n    ]\n  }\n}\n*/\n\nconst getStopovers = placesInUrl => {\n  if (!placesInUrl) return undefined\n  const items = placesInUrl.split(\"-\")\n  const result = []\n  // eslint-disable-next-line\n  for (let i = 0; i < items.length; i += 3)\n    // eslint-disable-next-line fp/no-mutating-methods\n    result.push({\n      locations: [items[i]],\n      nightsFrom: Number(items[i + 1]),\n      nightsTo: Number(items[i + 2])\n    })\n  return result\n}\n\nconst formatDate = date => format(date, \"DD/MM/YYYY\")\n\nconst getParamsFromQuery = ({\n  adults = 1,\n  dateFrom,\n  dateTo,\n  flyFrom = \"brno_cz\",\n  flyTo,\n  stopovers\n}) => ({\n  params: {\n    adults: Number(adults),\n    dateFrom: formatDate(\n      dateFrom ? new Date(dateFrom) : addDays(new Date(), 1)\n    ),\n    dateTo: formatDate(\n      dateTo ? new Date(dateTo) : addDays(new Date(), 30)\n    ),\n    flyFrom,\n    flyTo: flyTo || flyFrom,\n    stopovers: getStopovers(stopovers) || [\n      { locations: [\"LON\"], nightsFrom: 1, nightsTo: 7 },\n      { locations: [\"PAR\"], nightsFrom: 1, nightsTo: 7 }\n    ]\n  }\n})\n\nconst Result = ({ query }) => (\n  <>\n    {query.debug && <Debug queryParams={getParamsFromQuery(query)} />}\n    <Query\n      query={search}\n      variables={getParamsFromQuery(query)}\n      context={{ uri: \"https://weekend-api.now.sh/\" }}\n    >\n      {({ data }) => (\n        <ContentContainer>\n          <ResultsContainer>\n            <Stack direction=\"column\" spacing=\"extraLoose\">\n              <Heading type=\"title1\" spaceAfter=\"largest\">\n                Choose your flight combination\n              </Heading>\n              <Itinerary\n                flights={data.search.slice(0, 10)}\n                interest={query.interest}\n              />\n            </Stack>\n            <Footer\n              leftActions={\n                <Button\n                  type=\"secondary\"\n                  iconLeft={<ChevronLeft />}\n                  onClick={() =>\n                    // eslint-disable-next-line fp/no-mutating-methods\n                    Router.push({\n                      pathname: \"/\",\n                      query: Router.query\n                    })\n                  }\n                >\n                  Previous Step\n                </Button>\n              }\n            />\n          </ResultsContainer>\n        </ContentContainer>\n      )}\n    </Query>\n  </>\n)\n\n// enable passing query to main component\nResult.getInitialProps = async ({ query }) => ({ query })\n\nexport default Result\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAKA;;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AACA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AAGA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAZA;AADA;AAPA;AACA;AAwBA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAFA;AAFA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAZA;AARA;AACA;AACA;AA2CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}